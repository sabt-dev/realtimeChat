<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Realtime Chat</title>
    <link rel="stylesheet" href="/static/styles.css">
</head>
<body>
    <div class="chat-container">
        <div class="sidebar">
            <h3>Realtime Chat</h3>
            
            <div class="auth-section" id="authSection">
                <div class="login-options" id="loginOptions">
                    <h4>Login to Chat</h4>
                    <button class="auth-btn github-btn" onclick="loginWith('github')">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.012 8.012 0 0 0 16 8c0-4.42-3.58-8-8-8z"/>
                        </svg>
                        Login with GitHub
                    </button>
                    <button class="auth-btn google-btn" onclick="loginWith('google')">
                        <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                            <path d="M15.545 6.558a9.42 9.42 0 0 1 .139 1.626c0 2.434-.87 4.492-2.384 5.885h.002C11.978 15.292 10.158 16 8 16A8 8 0 1 1 8 0a7.689 7.689 0 0 1 5.352 2.082l-2.284 2.284A4.347 4.347 0 0 0 8 3.166c-2.087 0-3.86 1.408-4.492 3.304a4.792 4.792 0 0 0 0 3.063h.003c.635 1.893 2.405 3.301 4.492 3.301 1.078 0 2.004-.276 2.722-.764h-.003a3.702 3.702 0 0 0 1.599-2.431H8v-3.08h7.545z"/>
                        </svg>
                        Login with Google
                    </button>
                </div>
                
                <div class="user-info hidden" id="userInfo">
                    <div class="user-avatar" id="userAvatar"></div>
                    <div class="user-details">
                        <div class="user-name" id="userName"></div>
                        <div class="user-email" id="userEmail"></div>
                    </div>
                    <button class="logout-btn" onclick="logout()">Logout</button>
                </div>
            </div>

            <div class="join-form hidden" id="joinForm">
                <button id="createPublicRoomBtn">Create Public Room</button>
                <button id="createPrivateRoomBtn" class="private-room-btn">Create Private Room</button>
            </div>

            <div class="rooms-list" id="roomsList">
                <h4>Active Rooms</h4>
                <div id="rooms"></div>
            </div>
        </div>

        <div class="chat-area">
            <div class="login-screen" id="loginScreen">
                <div class="welcome-container">
                    <div class="floating-elements">
                        <div class="floating-element chat-bubble-1">üí¨</div>
                        <div class="floating-element chat-bubble-2">üì±</div>
                        <div class="floating-element chat-bubble-3">üöÄ</div>
                        <div class="floating-element chat-bubble-4">‚ú®</div>
                    </div>
                    
                    <div class="logo-container">
                        <div class="logo-glow"></div>
                        <h1 class="welcome-title">
                            <span class="title-word">Welcome</span>
                            <span class="title-word">to</span>
                            <span class="title-word highlight">Oshama</span>
                            <span class="title-word highlight">Chat</span>
                        </h1>
                    </div>
                    
                    <div class="welcome-subtitle">
                        <p class="subtitle-text">Connect instantly with friends and colleagues</p>
                        <p class="subtitle-subtext">Choose your login method from the sidebar to get started</p>
                    </div>
                    
                    <div class="features-preview">
                        <div class="feature-item">
                            <div class="feature-icon">üí¨</div>
                            <span>Real-time messaging</span>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">üì∏</div>
                            <span>Media sharing</span>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">üîí</div>
                            <span>Secure login</span>
                        </div>
                    </div>
                    
                    <div class="additional-features">
                        <div class="feature-row">
                            <div class="feature-card">
                                <div class="feature-card-icon">üåê</div>
                                <h3>Multiple Rooms</h3>
                                <p>Join different chat rooms and switch between conversations seamlessly</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-card-icon">‚ö°</div>
                                <h3>Lightning Fast</h3>
                                <p>WebSocket technology ensures instant message delivery with zero delays</p>
                            </div>
                        </div>
                        <div class="feature-row">
                            <div class="feature-card">
                                <div class="feature-card-icon">üì±</div>
                                <h3>Mobile Ready</h3>
                                <p>Responsive design works perfectly on desktop, tablet, and mobile devices</p>
                            </div>
                            <div class="feature-card">
                                <div class="feature-card-icon">üé®</div>
                                <h3>Modern UI</h3>
                                <p>Beautiful neon-themed interface with smooth animations and effects</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="tech-stack">
                        <h3>Powered by Modern Technology</h3>
                        <div class="tech-items">
                            <div class="tech-item">
                                <span class="tech-icon">üêπ</span>
                                <span>Go Backend</span>
                            </div>
                            <div class="tech-item">
                                <span class="tech-icon">üîå</span>
                                <span>WebSockets</span>
                            </div>
                            <div class="tech-item">
                                <span class="tech-icon">üóÑÔ∏è</span>
                                <span>GORM Database</span>
                            </div>
                            <div class="tech-item">
                                <span class="tech-icon">üîê</span>
                                <span>OAuth2</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="getting-started">
                        <div class="step-indicator">
                            <div class="step active">
                                <div class="step-number">1</div>
                                <span>Choose Login Method</span>
                            </div>
                            <div class="step-arrow">‚Üí</div>
                            <div class="step">
                                <div class="step-number">2</div>
                                <span>Enter Room Name</span>
                            </div>
                            <div class="step-arrow">‚Üí</div>
                            <div class="step">
                                <div class="step-number">3</div>
                                <span>Start Chatting</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="welcome-animation">
                        <div class="pulse-ring"></div>
                        <div class="pulse-ring delayed"></div>
                        <div class="pulse-ring more-delayed"></div>
                    </div>
                </div>
            </div>

            <!-- Start Chatting Screen (shown after login, before joining a room) -->
            <div class="login-screen hidden" id="startScreen">
                <div class="welcome-container">
                    <div class="logo-container">
                        <div class="logo-glow"></div>
                        <h1 class="welcome-title">
                            <span class="title-word">Start</span>
                            <span class="title-word">Chatting</span>
                        </h1>
                    </div>

                    <div class="welcome-subtitle">
                        <p class="subtitle-text">Pick a room from the left or create a new one</p>
                        <p class="subtitle-subtext">Use the buttons in the sidebar to create public or private rooms</p>
                    </div>

                    <div class="features-preview">
                        <div class="feature-item">
                            <div class="feature-icon">#</div>
                            <span>Select any room to join</span>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">‚ûï</div>
                            <span>Create your own room</span>
                        </div>
                        <div class="feature-item">
                            <div class="feature-icon">üë•</div>
                            <span>Invite friends to chat</span>
                        </div>
                    </div>
                </div>
            </div>

            <div class="hidden" id="chatInterface">
                <div class="chat-header">
                    <h2 id="roomTitle">Room</h2>
                    <div class="status" id="connectionStatus"></div>
                </div>

                <div class="messages" id="messages"></div>

                <!-- Reply Preview Area -->
                <div class="reply-preview" id="replyPreview" style="display: none;">
                    <div class="reply-preview-content">
                        <div class="reply-preview-header">
                            <span class="reply-icon">‚Ü©Ô∏è</span>
                            <span class="reply-text">Replying to</span>
                            <span class="reply-sender" id="replySender"></span>
                            <button class="reply-cancel" onclick="cancelReply()" title="Cancel reply">√ó</button>
                        </div>
                        <div class="reply-preview-message" id="replyPreviewMessage"></div>
                    </div>
                </div>

                <div class="message-input">
                    <button class="media-upload-btn" onclick="document.getElementById('fileInput').click()" title="Upload image or video">
                        üß∑
                    </button>
                    <input type="file" id="fileInput" class="file-input" accept="image/*,video/*" onchange="handleFileSelect(event)">
                    
                    <div class="message-input-wrapper">
                        <div class="upload-progress" id="uploadProgress">
                            <div class="upload-progress-text">
                                <span><span class="upload-progress-icon">üì§</span><span id="uploadText">Uploading</span><span class="loading-dots"></span></span>
                                <span id="uploadPercent">0%</span>
                            </div>
                            <div class="upload-progress-bar">
                                <div class="upload-progress-fill" id="uploadProgressFill" style="width: 0%"></div>
                            </div>
                        </div>
                        <img class="media-preview" id="mediaPreview" alt="Preview">
                        <video class="media-preview" id="videoPreview" controls></video>
                        <input type="text" id="messageInput" placeholder="Type your message..." maxlength="500">
                    </div>
                    
                    <button id="sendBtn">Send</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add image modal for full-size viewing -->
    <div id="imageModal" class="image-modal" onclick="closeImageModal()">
        <span class="close">&times;</span>
        <img id="modalImage" src="" alt="Full size image">
    </div>

    <!-- Public Room Creation Modal -->
    <div id="publicRoomModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create Public Room</h3>
                <span class="close" onclick="closePublicRoomModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="publicRoomName">Room Name:</label>
                    <input type="text" id="publicRoomName" placeholder="Enter room name" maxlength="30" required>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-cancel" onclick="closePublicRoomModal()">Cancel</button>
                <button type="button" class="btn-create" onclick="submitPublicRoom()" id="createPublicRoomBtn">Create Room</button>
            </div>
        </div>
    </div>

    <!-- Private Room Creation Modal -->
    <div id="privateRoomModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Create Private Room</h3>
                <span class="close" onclick="closePrivateRoomModal()">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="privateRoomName">Room Name:</label>
                    <input type="text" id="privateRoomName" placeholder="Enter room name" maxlength="50" required>
                </div>
                
                <div class="form-group">
                    <label for="privateRoomDescription">Description (optional):</label>
                    <textarea id="privateRoomDescription" placeholder="Room description" maxlength="200"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="userSearch">Add Users:</label>
                    <div class="user-search-container">
                        <input type="text" id="userSearch" placeholder="Search users by name or email..." autocomplete="off">
                        <div id="userSearchResults" class="search-results"></div>
                    </div>
                </div>
                
                <div class="selected-users" id="selectedUsers">
                    <h4>Selected Users:</h4>
                    <div id="selectedUsersList" class="selected-users-list">
                        <!-- Selected users will be displayed here -->
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn-cancel" onclick="closePrivateRoomModal()">Cancel</button>
                <button type="button" class="btn-create" onclick="createPrivateRoom()" id="createRoomBtn">Create Room</button>
            </div>
        </div>
    </div>

    <script src="/static/chat.js"></script>
</body>
</html>
